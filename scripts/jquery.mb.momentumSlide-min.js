$.fn.CSSAnimate=function(t,e,n,o,i){return this.each((function(){var a=$(this);if(0!==a.length&&t){if("function"==typeof e&&(i=e),"function"==typeof n&&(i=n),"function"==typeof o&&(i=o),"string"==typeof e)for(var r in $.fx.speeds){if(e==r){e=$.fx.speeds[r];break}e=null}if(e||(e=$.fx.speeds._default),n||(n="cubic-bezier(0.65,0.03,0.36,0.72)"),o||(o="all"),jQuery.support.transition){var s="",d="transitionEnd";for(var c in $.browser.webkit?(s="-webkit-",d="webkitTransitionEnd"):$.browser.mozilla?(s="-moz-",d="transitionend"):$.browser.opera?(s="-o-",d="oTransitionEnd"):$.browser.msie&&(s="-ms-",d="msTransitionEnd"),t)"transform"===c&&(t[s+"transform"]=t[c],delete t[c]),"transform-origin"===c&&(t[s+"transform-origin"]=t[c],delete t[c]);a.css(s+"transition-property",o),a.css(s+"transition-duration",e+"ms"),a.css(s+"transition-timing-function",n),setTimeout((function(){a.css(t)}),0);var u=function(){a.get(0).removeEventListener(d,u,!1),a.css(s+"transition",""),"function"==typeof i&&i()};a.get(0).addEventListener(d,u,!1)}else a.animate(t,e,i)}}))},$.fn.CSSAnimateStop=function(){var t="";$.browser.webkit?t="-webkit-":$.browser.mozilla?t="-moz-":$.browser.opera?t="-o-":$.browser.msie&&(t="-ms-"),$(this).css(t+"transition","")},$.support.transition=function(){var t=(document.body||document.documentElement).style;return void 0!==t.transition||void 0!==t.WebkitTransition||void 0!==t.MozTransition||void 0!==t.MsTransition||void 0!==t.OTransition}(),function($){$.mbMomentumSlide={name:"mb.momentumSlide",author:"Matteo Bicocchi",version:"1.0",defaults:{duration:600,direction:"h",waitBefore:100,propagate:!0,anchor:0,pagination:5,activateKeyboard:!0,indexPlaceHolder:null,onInit:function(t){},onStart:function(t){},onDrag:function(t){},onBeforeEnd:function(t){},onEnd:function(t){},onBounceStart:function(t){},onBounceEnd:function(t){},onGoTo:function(t){}},init:function(t){var e=navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad)/),n="ontouchstart"in window,o={};o.start=n?"touchstart":"mousedown",o.move=n?"touchmove":"mousemove",o.end=n?"touchend":"mouseup",o.windowResize=n&&e?"orientationchange":"resize";var i=arguments;this.each((function(){var e=this,a=$(this);if(a.addClass(".mbMomentumSlider"),"string"!=typeof i[0]){a.addClass("cursorGrab"),e.opt={},e.margin={},e.isDevice=n,e.cancelScroll=!1,e.scrolled=!1,e.hasTouch=n,e.page=0,e.bounceStartCalled=!1,e.bounceEndCalled=!1,e.opt.id=e.id?e.id:"moms_"+(new Date).getTime(),$.extend(e.opt,$.mbMomentumSlide.defaults,t),$("img",a).bind("dragstart.mbMomentum_"+e.opt.id,(function(t){t.preventDefault()}));var r=$("<div/>").addClass("mbScrollWrapper_"+e.opt.id).css({position:"relative",lineHeight:0,margin:0});a.wrapInner(r),a.css({overflow:"hidden"}),e.container=$(".mbScrollWrapper_"+e.opt.id,a);var s="h"==e.opt.direction?{height:"100%",display:"inline"}:{width:"100%"};e.container.css(s),e.pages=$(e.container).children(),e.pages.each((function(t){var n=$("<div/>").addClass("pageContent");$(this).wrapInner(n);var o="h"==e.opt.direction?{display:"inline-block",width:a.outerWidth()}:{display:"block",height:a.outerHeight()};$(this).css(o).attr("data-idx",t),e.container.append($(this)),this.content=$(".pageContent",$(this)).get(0)})),e.w=e.container.outerWidth(!0)-e.pages.outerWidth(),e.h=e.container.outerHeight(!0)-e.pages.outerHeight(),a.unbind(o.start+".mbMomentum_"+e.opt.id).bind(o.start+".mbMomentum_"+e.opt.id,(function(t){$.mbMomentumSlide.start(t,e)})),a.unbind(o.move+".mbMomentum_"+e.opt.id).bind(o.move+".mbMomentum_"+e.opt.id,(function(t){$.mbMomentumSlide.move(t,e)})),$(document).unbind(o.end+".mbMomentum_"+e.opt.id).bind(o.end+".mbMomentum_"+e.opt.id,(function(){$.mbMomentumSlide.end(e)})),$(window).unbind(o.windowResize+".mbMomentum_"+e.opt.id).bind(o.windowResize+".mbMomentum_"+e.opt.id,(function(){$.mbMomentumSlide.refresh(e)})),e.opt.activateKeyboard&&$(document).bind("keydown."+e.opt.id,(function(t){var n=t.which;37==n&&$.mbMomentumSlide.prev(e),39==n&&$.mbMomentumSlide.next(e)})),$(e.opt.indexPlaceHolder).length>0&&$.mbMomentumSlide.buildIndex(e),"function"==typeof e.opt.onInit&&e.opt.onInit(e),a.bind("goto..mbMomentum_"+e.opt.id,(function(t){"function"==typeof e.opt.onGoTo&&e.opt.onGoTo(e)})),$.mbMomentumSlide.goTo(e,1)}else switch(i[0]){case"goto":$.mbMomentumSlide.goTo(e,i[1]);break;case"next":$.mbMomentumSlide.next(e);break;case"prev":$.mbMomentumSlide.prev(e);break;case"refresh":$.mbMomentumSlide.refresh(e);break;case"end":$.mbMomentumSlide.end(e)}}))},start:function(t,e){var n=$(e);e.container.CSSAnimateStop(),e.bounceStartCalled=!1,e.bounceEndCalled=!1,e.anchored=!0;var o=t;e.hasTouch&&(t=(t=t.originalEvent).touches[0]),$("body").unselectable(),e.timer=setTimeout((function(){e.canScroll=!0,$(e).addClass("cursorGrabbing")}),e.opt.waitBefore),e.startX=t.clientX,e.startY=t.clientY,e.startPosX=parseFloat(e.container.css("margin-left")),e.startPosY=parseFloat(e.container.css("margin-top")),e.w=e.container.outerWidth()-n.outerWidth(),e.h=e.container.outerHeight()-n.outerHeight(),$.mbMomentumSlide.refresh(e),"function"==typeof e.opt.onStart&&e.opt.onStart(e),e.opt.propagate||o.stopPropagation()},move:function(t,e){var n="h"==e.opt.direction?parseFloat(e.container.css("margin-left")):parseFloat(e.container.css("margin-top")),o=t;if(e.hasTouch&&(t=(t=t.originalEvent).touches[0]),o.preventDefault(),e.x=e.endX=t.clientX,e.y=e.endY=t.clientY,e.locked=!1,"h"==e.opt.direction?e.locked=Math.abs(e.startY-e.endY)>Math.abs(e.startX-e.endX)+50:"v"==e.opt.direction&&(e.locked=Math.abs(e.startX-e.endX)>Math.abs(e.startY-e.endY)+50),e.canScroll&&!e.locked){e.scrolling=!0;var i="h"==e.opt.direction?Math.abs(e.startY-e.endY):Math.abs(e.startX-e.endX),a="h"==e.opt.direction?e.w:e.h,r=n>=0||n<=-a?6:1,s=Math.floor(e.startX-t.clientX)/r,d=Math.floor(e.startY-t.clientY)/r;n>10&&!e.bounceStartCalled?"function"==typeof e.opt.onBounceStart&&(e.opt.onBounceStart(e),e.bounceStartCalled=!0):n<-(a+10)&&!e.bounceEndCalled?"function"==typeof e.opt.onBounceEnd&&(e.opt.onBounceEnd(e),e.bounceEndCalled=!0):i<e.opt.anchor&&e.anchored?o.stopPropagation():e.anchored=!1;var c="h"==e.opt.direction?s<0?"left":"right":d<0?"top":"bottom",u="h"==e.opt.direction?{"margin-left":e.startPosX-s}:{"margin-top":e.startPosY-d};e.container.css(u),"function"==typeof e.opt.onDrag&&e.opt.onDrag(e,c)}else e.locked&&$(e).momentumSlide("end")},end:function(t){var e=$(t);if(clearTimeout(t.timer),t.canScroll=!1,e.removeClass("cursorGrabbing"),t.scrolling){t.scrolling=!1,t.pageW=e.outerWidth(),t.pageH=e.outerHeight(),t.changePoint="h"==t.opt.direction?t.pageW/2:t.pageH/2;var n=Math.abs(t.startX-t.endX)>t.changePoint&&parseFloat(t.container.css("margin-left"))<0&&t.pages.eq(t.page).length>0,o=Math.abs(t.startY-t.endY)>t.changePoint&&parseFloat(t.container.css("margin-top"))<0&&t.pages.eq(t.page).length>0,i="h"==t.opt.direction?n:o,a=t.page;if(i)("h"==t.opt.direction?t.endX<t.startX:t.endY<t.startY)?t.pages.eq(t.page+1).length>0&&t.page++:t.pages.eq(t.page-1).length>0&&t.page--;t.page!=a&&(t.oldPage=a),$.mbMomentumSlide.goTo(t,t.page+1),t.anchored=!1}},refresh:function(t){if(t.opt){var e=$(t);t.pages=$(t.container).children(),t.pages.each((function(){var n="h"==t.opt.direction?{width:e.outerWidth()}:{height:e.outerHeight()};$(this).css(n)}));var n="h"==t.opt.direction?{marginLeft:-e.outerWidth()*t.page,width:e.outerWidth()*t.pages.length}:{marginTop:-e.outerHeight()*t.page,height:e.outerHeight()*t.pages.length};t.container.css(n)}},next:function(t){t.oldPage=t.page,"function"==typeof t.opt.onDrag&&t.opt.onDrag(t,"right"),t.page<t.pages.length-1&&t.page++,$.mbMomentumSlide.goTo(t,t.page+1)},prev:function(t){t.oldPage=t.page,"function"==typeof t.opt.onDrag&&t.opt.onDrag(t,"left"),t.page>0&&t.page--,$.mbMomentumSlide.goTo(t,t.page+1)},goTo:function(t,e,n){void 0===n&&(n=!0);var o=$(t);(e-=1)>=0&&e<t.pages.length?t.page=e:t.page=0,t.actualPage=t.pages[t.page];var i=$.Event("goto");i.el=t,$(t).trigger(i);var a="h"==t.opt.direction?-o.outerWidth()*t.page:-o.outerHeight()*t.page,r="h"==t.opt.direction?{marginLeft:a}:{marginTop:a};"function"==typeof t.opt.onBeforeEnd&&t.opt.onBeforeEnd(t);var s=n?t.opt.duration:1;t.container.CSSAnimate(r,s,"cubic-bezier(0,.98,.26,.97)","all",(function(){"function"==typeof t.opt.onEnd&&t.opt.onEnd(t),t.locked=!1})),$(t.opt.indexPlaceHolder).length>0&&$.mbMomentumSlide.buildIndex(t)},buildIndex:function(t){var e=$(t.opt.indexPlaceHolder);if(e.empty(),1!=t.pages.length){var n=$("<div/>").addClass("idxContainer");e.append(n);for(var o=0;o<t.pages.length;o++){var i=$("<div/>").addClass("idxPage").attr("id","pageIdx_"+o).data("idx",o);i.click((function(){$.mbMomentumSlide.goTo(t,$(this).data("idx")+1)})),n.append(i)}$(".idxPage",e).eq(t.page).addClass("sel")}},getNextPage:function(t){return t.pages.eq(t.page+1)},getPrevPage:function(t){return t.pages.eq(t.page-1)}},$.fn.momentumSlide=$.mbMomentumSlide.init,$.fn.unselectable=function(){return this.each((function(){$(this).css({"-moz-user-select":"none","-khtml-user-select":"none","user-select":"none"}).attr("unselectable","on")})),$(this)},$.fn.clearUnselectable=function(){return this.each((function(){$(this).css({"-moz-user-select":"auto","-khtml-user-select":"auto","user-select":"auto"}),$(this).removeAttr("unselectable")})),$(this)}}(jQuery);